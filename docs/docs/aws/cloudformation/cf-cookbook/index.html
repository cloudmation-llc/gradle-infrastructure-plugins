<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.58">
<title data-react-helmet="true">Cookbook | Infrastructure Gradle Plugins by Cloudmation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Cookbook | Infrastructure Gradle Plugins by Cloudmation"><meta data-react-helmet="true" name="description" content="The following is a selection of interesting things that you can do using the CloudFormation plugin to organize and deploy your stacks."><meta data-react-helmet="true" property="og:description" content="The following is a selection of interesting things that you can do using the CloudFormation plugin to organize and deploy your stacks."><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-cookbook"><link data-react-helmet="true" rel="shortcut icon" href="/gradle-infrastructure-plugins/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-cookbook"><link rel="stylesheet" href="/gradle-infrastructure-plugins/styles.9fe210f1.css">
<link rel="preload" href="/gradle-infrastructure-plugins/styles.c41e265b.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/runtime~main.394ce800.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/main.59d1dab0.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/1.cccfd9f4.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/2.3bdf6a13.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/15.b130aa02.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/baa0e5da.0b8cdc42.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/17896441.e944b507.js" as="script">
<link rel="preload" href="/gradle-infrastructure-plugins/04a2298f.9bf7881c.js" as="script">
</head>
<body>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/gradle-infrastructure-plugins/"><img class="navbar__logo" src="/gradle-infrastructure-plugins/img/logo.svg" alt="Cloudmation LLC Logo"><strong class="navbar__title">Infrastructure Gradle Plugins by Cloudmation</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/gradle-infrastructure-plugins/"><img class="navbar__logo" src="/gradle-infrastructure-plugins/img/logo.svg" alt="Cloudmation LLC Logo"><strong class="navbar__title">Infrastructure Gradle Plugins by Cloudmation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp" role="complementary"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/gradle-infrastructure-plugins/docs/about">About</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">AWS (Amazon Web Services)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gradle-infrastructure-plugins/docs/aws/global-config">Global Configuration</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">CloudFormation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-tutorial-basics">Tutorial (The Basics)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-config">Configuration</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-cookbook">Cookbook</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gradle-infrastructure-plugins/docs/aws/roadmap">Roadmap</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Cookbook</h1></header><div class="markdown"><p>The following is a selection of interesting things that you can do using the CloudFormation plugin to organize and deploy your stacks.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="parameterized-deployments"></a>Parameterized Deployments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#parameterized-deployments" title="Direct link to heading">#</a></h2><p><a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins/tree/master/examples/src/cloudformation/cookbook-params-and-dependencies" target="_blank" rel="noopener noreferrer"><strong>Example in Github</strong></a></p><p>This has been touched on in the <a href="/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-config">configuration</a> page, but I wanted to reiterate the value gained from parameterizing templates. Using parameters effectively opens an opportunity to use <em>one template</em> for multiple stack deployments. Doing so cuts down on the number of template files that need to be maintained.</p><p>The default design of the plugin is to read your template files, and come up with a sensible assumption about how to deploy them. In the situation of wanting to use single template, and deploy it multiple times with varying parameter values, the plugin cannot guess what needs to be done, and instead you need to provide the config.</p><p>Take a look at the <a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins/tree/master/examples/src/cloudformation/cookbook-params-and-dependencies" target="_blank" rel="noopener noreferrer">parameterization example</a>. In the build config, you can exclude tasks that were created automatically by the plugin, and instead define the specific stacks that you want deployed and their parameters. Note how the same template file is used repeatedly.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="using-dependencies-for-complex-deployments"></a>Using Dependencies for Complex Deployments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-dependencies-for-complex-deployments" title="Direct link to heading">#</a></h2><p><a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins/tree/master/examples/src/cloudformation/cookbook-params-and-dependencies" target="_blank" rel="noopener noreferrer"><strong>Example in Github</strong></a></p><p>Gradle provides really nice tools to organize the task graph, and arrange the order of how tasks should be deployed. Since the plugin creates a task for each stack deployment, you can take advantage of task ordering to define complex deployments.</p><p>Use an <code>afterEvaluate</code> block to configure task dependencies. In the <a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins/tree/master/examples/src/cloudformation/cookbook-params-and-dependencies" target="_blank" rel="noopener noreferrer">provided example</a>, note how the subnet stacks are not deployed until the VPC stack is first created successfully.</p><p>Use Gradle properties such as <code>dependsOn</code>, <code>mustRunBefore</code>, and <code>mustRunAfter</code> to chain together tasks.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-groovy codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">afterEvaluate {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deployNetworkZoneA.dependsOn deployVpc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deployNetworkZoneB.dependsOn deployVpc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deployNetworkZoneC.dependsOn deployVpc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deployNetworkZoneD.dependsOn deployVpc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="task-groups"></a>Task Groups<a aria-hidden="true" tabindex="-1" class="hash-link" href="#task-groups" title="Direct link to heading">#</a></h2><p><a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins/tree/master/examples/src/cloudformation/cookbook-params-and-dependencies" target="_blank" rel="noopener noreferrer"><strong>Example in Github</strong></a></p><p>Setting task dependencies is nice, but what if you want to run them all in one shot? You can create custom tasks in Gradle that simply call other tasks according to the define dependencies.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-groovy codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">afterEvaluate {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // Define a task to deploy all of the others</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    task &quot;deployNetwork&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        group = &quot;AWS Network&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        description = &quot;Deploy all of the network resources&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        dependsOn deployNetworkZoneA, deployNetworkZoneB, deployNetworkZoneC, deployNetworkZoneD</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/gradle-infrastructure-plugins/docs/aws/cloudformation/cf-config"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« CloudFormation Configuration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/gradle-infrastructure-plugins/docs/aws/roadmap"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Roadmap »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#parameterized-deployments" class="table-of-contents__link">Parameterized Deployments</a></li><li><a href="#using-dependencies-for-complex-deployments" class="table-of-contents__link">Using Dependencies for Complex Deployments</a></li><li><a href="#task-groups" class="table-of-contents__link">Task Groups</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/gradle-infrastructure-plugins/about">About</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/cloudmation-llc/gradle-infrastructure-plugins" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Cloudmation LLC. Built with Docusaurus.</div></div></div></footer></div>
<script src="/gradle-infrastructure-plugins/styles.c41e265b.js"></script>
<script src="/gradle-infrastructure-plugins/runtime~main.394ce800.js"></script>
<script src="/gradle-infrastructure-plugins/main.59d1dab0.js"></script>
<script src="/gradle-infrastructure-plugins/1.cccfd9f4.js"></script>
<script src="/gradle-infrastructure-plugins/2.3bdf6a13.js"></script>
<script src="/gradle-infrastructure-plugins/15.b130aa02.js"></script>
<script src="/gradle-infrastructure-plugins/baa0e5da.0b8cdc42.js"></script>
<script src="/gradle-infrastructure-plugins/17896441.e944b507.js"></script>
<script src="/gradle-infrastructure-plugins/04a2298f.9bf7881c.js"></script>
</body>
</html>